<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 500px;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
        }

        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        .details {
            margin-top: 20px;
            text-align: left;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üßπ –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞</h1>
        <div id="status"></div>
        <button onclick="clearAllCache()">–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫–µ—à</button>
        <button onclick="location.reload()">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
        <div class="details" id="details"></div>
    </div>

    <script>
        function clearAllCache() {
            const statusDiv = document.getElementById('status');
            const detailsDiv = document.getElementById('details');
            let cleared = [];

            try {
                // –û—á–∏—Å—Ç–∫–∞ localStorage
                const localStorageKeys = Object.keys(localStorage);
                localStorage.clear();
                cleared.push(`‚úì localStorage –æ—á–∏—â–µ–Ω (${localStorageKeys.length} –∫–ª—é—á–µ–π)`);

                // –û—á–∏—Å—Ç–∫–∞ sessionStorage
                const sessionStorageKeys = Object.keys(sessionStorage);
                sessionStorage.clear();
                cleared.push(`‚úì sessionStorage –æ—á–∏—â–µ–Ω (${sessionStorageKeys.length} –∫–ª—é—á–µ–π)`);

                // –û—á–∏—Å—Ç–∫–∞ cookies
                const cookies = document.cookie.split(";");
                for (let cookie of cookies) {
                    const eqPos = cookie.indexOf("=");
                    const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                    document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
                }
                cleared.push(`‚úì Cookies –æ—á–∏—â–µ–Ω—ã (${cookies.length} cookie)`);

                // –ü–æ–ø—ã—Ç–∫–∞ –æ—á–∏—Å—Ç–∏—Ç—å Service Workers
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.getRegistrations().then(function (registrations) {
                        for (let registration of registrations) {
                            registration.unregister();
                        }
                        cleared.push(`‚úì Service Workers —É–¥–∞–ª–µ–Ω—ã (${registrations.length})`);
                        updateStatus();
                    });
                }

                // –ü–æ–ø—ã—Ç–∫–∞ –æ—á–∏—Å—Ç–∏—Ç—å Cache API
                if ('caches' in window) {
                    caches.keys().then(function (names) {
                        for (let name of names) {
                            caches.delete(name);
                        }
                        cleared.push(`‚úì Cache API –æ—á–∏—â–µ–Ω (${names.length} –∫–µ—à–µ–π)`);
                        updateStatus();
                    });
                }

                updateStatus();

            } catch (error) {
                statusDiv.innerHTML = `<div class="status" style="background: #f8d7da; color: #721c24;">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }

            function updateStatus() {
                statusDiv.innerHTML = '<div class="status success">‚úÖ –ö–µ—à —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω!</div>';
                detailsDiv.innerHTML = '<h3>–û—á–∏—â–µ–Ω–æ:</h3><ul>' +
                    cleared.map(item => `<li>${item}</li>`).join('') +
                    '</ul><p><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> –ù–∞–∂–º–∏—Ç–µ Ctrl+Shift+R (–∏–ª–∏ Cmd+Shift+R –Ω–∞ Mac) –¥–ª—è –∂–µ—Å—Ç–∫–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.</p>';
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function () {
            const statusDiv = document.getElementById('status');
            const localCount = Object.keys(localStorage).length;
            const sessionCount = Object.keys(sessionStorage).length;

            statusDiv.innerHTML = `<div class="status info">
                üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:<br>
                localStorage: ${localCount} –∫–ª—é—á–µ–π<br>
                sessionStorage: ${sessionCount} –∫–ª—é—á–µ–π
            </div>`;
        };
    </script>
</body>

</html>